<!DOCTYPE html>

<html lang="en" class="h-100">

<head>

  
  

  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:type" content="website">
  <meta property="og:title" content="kima | Documentation">
  <meta property="og:description" content="A data analysis framework  for exoplanet detection">

  <title>kima | Documentation</title>
  <meta name="description" content="A data analysis framework  for exoplanet detection">

  
  <!-- <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico"> -->

  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">


  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.10.0/css/all.css">

  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

  <!-- Animate CSS CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css" type="text/css"/>
  
  <!-- KaTeX CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css" integrity="sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js" integrity="sha384-GxNFqL3r9uRJQhR+47eDxuPoNE7yLftQM8LcxzgS4HT73tp970WS/wV5p8UzCOmb" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"></script>
  <script>
      document.addEventListener("DOMContentLoaded", function() {
          renderMathInElement(document.body, {
            // customised options
            // • auto-render specific keys, e.g.:
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false},
                {left: '\\(', right: '\\)', display: false},
                {left: '\\[', right: '\\]', display: true}
            ],
            // • rendering keys, e.g.:
            throwOnError : false
          });
      });
  </script>


  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/style.css" type="text/css">

</head>


<body class="d-flex flex-column h-100">

  <main class="flex-shrink-0 container mt-5">
  <nav class="navbar navbar-expand-md navbar-light">

  <a class="navbar-brand" href="/"><b>kima</b></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav ml-auto">
<a class="nav-item nav-link " href="/pages/docs-parts/analysis-of-results/analysis-of-results"></a>
      
      <a class="nav-item nav-link " href="/pages/docs-parts/analysis-of-results/interactive-analysis"></a>
      
      <a class="nav-item nav-link " href="/pages/docs-parts/analysis-of-results/quick-plots"></a>
      
      <a class="nav-item nav-link " href="/pages/docs-parts/building-models/background-model"></a>
      
      <a class="nav-item nav-link " href="/pages/docs-parts/building-models/building-models"></a>
      
      <a class="nav-item nav-link " href="/pages/docs-parts/building-models/general-settings"></a>
      
      <a class="nav-item nav-link " href="/pages/docs-parts/building-models/known-objects"></a>
      
      <a class="nav-item nav-link " href="/pages/docs-parts/building-models/np-planets"></a>
      
      <a class="nav-item nav-link " href="/pages/docs-parts/building-models/setting-priors"></a>
      
      <a class="nav-item nav-link " href="/pages/docs-parts/building-models/types-of-models"></a>
      
      <a class="nav-item nav-link " href="/pages/docs-parts/getting-started"></a>
      
      <a class="nav-item nav-link " href="/pages/docs-parts/installation"></a>
      
      <a class="nav-item nav-link " href="/pages/docs-parts/loading-data/activity-correlations"></a>
      
      <a class="nav-item nav-link " href="/pages/docs-parts/loading-data/loading-data"></a>
      
      <a class="nav-item nav-link " href="/pages/docs-parts/tldr"></a>
      
      <a class="nav-item nav-link " href="/about">About</a>
      
      <a class="nav-item nav-link " href="/news">News</a>
      
      <a class="nav-item nav-link active" href="/docs/">Documentation</a>
      
      <a class="nav-item nav-link " href="/API">API</a>
      
      
      
      <a class="nav-item nav-link" href="https://github.com/j-faria/kima" alt="Github repository">
        <i class="fab fa-github"></i>
      </a>

    </div>
  </div>
  
</nav>
  <div class="col-lg-10 mx-auto mt-5 post">
  
    
<div class="toc__cont">
<ul class="toc">
<li class="toc__items"><a href="#tldr">TL;DR</a></li>
<li class="toc__items"><a href="#installation">Installation</a></li>
<li class="toc__items">
<a href="#getting-started">Getting started</a><ul>
<li class="toc__items"><a href="#running-the-examples">Running the examples</a></li>
<li class="toc__items"><a href="#creating-a-template-directory">Creating a template directory</a></li>
</ul>
</li>
<li class="toc__items">
<a href="#building-models">Building models</a><ul>
<li class="toc__items"><a href="#general-settings">General settings</a></li>
<li class="toc__items"><a href="#types-of-models">Types of models</a></li>
<li class="toc__items"><a href="#the-n_p-planets">The $N_p$ planets</a></li>
<li class="toc__items"><a href="#the-background-model">The “background” model</a></li>
<li class="toc__items"><a href="#the-known-objects">The known object(s)</a></li>
<li class="toc__items">
<a href="#setting-the-priors">Setting the priors</a><ul>
<li class="toc__items"><a href="#checking-if-the-priors-are-correct">Checking if the priors are correct</a></li>
<li class="toc__items"><a href="#default-priors">Default priors</a></li>
</ul>
</li>
</ul>
</li>
</ul>  

</div>
  

  <!-- https://github.com/vfeskov/vanilla-back-to-top -->
<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>

<script>addBackToTop({
  diameter: 30, // px
  cornerOffset: 17, // px
  showWhenScrollTopIs: 50, // px
  backgroundColor: 'rgb(255, 82, 82)',
  textColor: '#fff'
})</script>

<h4 id="tldr">TL;DR</h4>

<p>If you’re busy, do this</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone --recursive https://github.com/j-faria/kima.git
cd kima
make -j 4
python setup.py install

cd examples/*CHOOSE ONE*
kima-run

kima-showresults all
</code></pre></div></div>

<p>For more details, read on.</p>

<h4 id="installation">Installation</h4>

<p><strong>kima</strong> is written in C++ and needs to be compiled, so you will need a working
 C++ compiler.<br>
 <!--  -->
 We run regular tests with the <em>gcc</em> and <em>clang</em> compilers: <img style="vertical-align:middle;" src="https://github.com/j-faria/kima/actions/workflows/compilers.yml/badge.svg"></p>

<p>To install, first clone the GitHub repository <img class="emoji" title=":octocat:" alt=":octocat:" src="https://github.githubassets.com/images/icons/emoji/octocat.png" height="20" width="20"></p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> git clone <span class="nt">--recursive</span> https://github.com/j-faria/kima.git
</code></pre></div></div>

<blockquote>
  <p>don’t foget the <code class="language-plaintext highlighter-rouge">--recursive</code> to download the required submodules.</p>
</blockquote>

<p>then go to the <em>kima</em> directory and compile the code (optionally, in parallel)</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">cd </span>kima
 make  <span class="c"># -j 4</span>
</code></pre></div></div>

<p>To analyse the results, <strong>kima</strong> comes with a helper Python package called
 <code class="language-plaintext highlighter-rouge">pykima</code>.<br>
 To install <code class="language-plaintext highlighter-rouge">pykima</code>, from inside the <em>kima</em> directory run</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> python setup.py <span class="nb">install</span>  <span class="c"># or python setup.py develop</span>
</code></pre></div></div>

<blockquote>
  <p>you may choose to analyse the results without <code class="language-plaintext highlighter-rouge">pykima</code> since the inputs and
   outputs of <strong>kima</strong> itself are simple text files. <code class="language-plaintext highlighter-rouge">pykima</code> will just make it
   easier.</p>
</blockquote>

<p>If the installation fails, take a look at the
 <a href="https://github.com/j-faria/kima/wiki/Troubleshooting" target="_blank">troubleshooting</a>
 section of the wiki or <a href="https://github.com/j-faria/kima/issues" target="_blank">open an
 issue</a>.</p>
<h4 id="getting-started">Getting started</h4>

<h5 id="running-the-examples">Running the examples</h5>

<p><strong>kima</strong> comes packed with ready-to-run examples inside the <em>kima/examples</em>
 directory. All of them are described to some length
 <a href="/examples">here</a>.</p>

<p>To run any example, go to the directory and use the <code class="language-plaintext highlighter-rouge">kima-run</code> script (part of
 <code class="language-plaintext highlighter-rouge">pykima</code>)</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">cd </span>examples/<span class="k">*</span>CHOOSE ONE<span class="k">*</span>
 kima-run
</code></pre></div></div>

<h5 id="creating-a-template-directory">Creating a template directory</h5>

<p>After installing <code class="language-plaintext highlighter-rouge">pykima</code>, you can run the <code class="language-plaintext highlighter-rouge">kima-template</code> script to create a
 template directory containing the necessary files to run <strong>kima</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> kima-template my-new-planet
 <span class="c"># Populating directory my-new-planet</span>
 <span class="c"># with kima template files: kima_setup.cpp, OPTIONS, Makefile, README.md</span>
</code></pre></div></div>

<p>You can now modify the <code class="language-plaintext highlighter-rouge">kima_setup.cpp</code> file to set up the model and run the
 analysis with <code class="language-plaintext highlighter-rouge">kima-run</code> as for the examples.</p>

<h4 id="building-models">Building models</h4>
<h5 id="general-settings">General settings</h5>

<p>Every model in <strong>kima</strong> starts with a few general settings</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">const</span> <span class="kt">bool</span> <span class="n">GP</span>
<span class="k">const</span> <span class="kt">bool</span> <span class="n">MA</span>
<span class="k">const</span> <span class="kt">bool</span> <span class="n">hyperpriors</span>
<span class="k">const</span> <span class="kt">bool</span> <span class="n">trend</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">degree</span>
<span class="k">const</span> <span class="kt">bool</span> <span class="n">multi_instrument</span>
<span class="k">const</span> <span class="kt">bool</span> <span class="n">known_object</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">n_known_object</span>
<span class="k">const</span> <span class="kt">bool</span> <span class="n">studentt</span>
</code></pre></div></div>

<p>which <strong>always</strong> need to be defined.</p>

<blockquote>
  <p>yes, this is annoying, I’m working on a solution!</p>
</blockquote>

<p>While some are self-explanatory, others can get be a bit tricky to understand.
Here’s a short explanation for each one.</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">GP</code><br>
Whether to use a Gaussian process (GP) as a model for correlated noise in
the RVs.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">MA</code><br>
Whether to use a Moving Average as a model for correlated noise in the RVs.</p>

    <blockquote>
      <p>the moving average model is still experimental</p>
    </blockquote>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">hyperpriors</code><br>
Whether to use hyper-priors for the orbital periods and for the
semi-amplitudes of the planets. See the section on
<a href="#setting-the-priors">priors</a> for more information.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">trend</code> and <code class="language-plaintext highlighter-rouge">degree</code><br>
Consider a long-term trend in the RVs, of a given degree. This is a linear
trend for <code class="language-plaintext highlighter-rouge">degree=1</code>, a quadratic for <code class="language-plaintext highlighter-rouge">degree=2</code>, and a cubic for <code class="language-plaintext highlighter-rouge">degree=3</code>.
Higher degree trends are not implemented.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">multi_instrument</code><br>
Whether the RV data comes from multiple instruments. See this
<a href="/blog/multi-instrument">example</a> for more information.</p>

    <blockquote>
      <p>a typical source of issues is loading multiple datasets with the
  <code class="language-plaintext highlighter-rouge">load_multi</code> function (see below) but forgetting to set <code class="language-plaintext highlighter-rouge">multi_instrument =
  true</code>.</p>
    </blockquote>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">known_object</code> and <code class="language-plaintext highlighter-rouge">n_known_object</code><br>
In known object (KO!) mode, <strong>kima</strong> considers some Keplerians as part of a
“background” model, not included in the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">N_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> other planets. This can be
useful when modeling transiting planets or simply planets with better-known
orbital parameters.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">studentt</code><br>
Whether to use a Student-t distribution as the likelihood, instead of a
Gaussian. If this is set to <code class="language-plaintext highlighter-rouge">true</code>, the degrees of freedom <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ν</mi></mrow><annotation encoding="application/x-tex">\nu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.06366em;">ν</span></span></span></span> of the
Student-t distribution can be estimated from the data. This is sometimes
useful when the RV data is suspected to contain (a few) strong outliers. See
the <a href="/blog/student-t">example</a> for more information.</p>
  </li>
</ul>

<h5 id="types-of-models">Types of models</h5>

<p><strong>kima</strong> currently implements two kinds of models</p>

<ul>
  <li>
    <p>RVmodel<br>
which models the RVs with a sum-of-Keplerians</p>
  </li>
  <li>
    <p>RVFWHMmodel<br>
which models the RVs together with the FWHM as an activity indicator</p>
  </li>
</ul>

<p>The type of model to be used is set by defining a <em>constructor</em> like</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">RVmodel</span><span class="o">::</span><span class="n">RVmodel</span><span class="p">()</span>
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>or</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">RVFWHMmodel</span><span class="o">::</span><span class="n">RVFWHMmodel</span><span class="p">()</span>
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div>

<blockquote>
  <p>a <em>constructor</em> in C++ is a special function that instantiates an object, in
this case of type <code class="language-plaintext highlighter-rouge">RVmodel</code> or <code class="language-plaintext highlighter-rouge">RVFWHMmodel</code>. If this sounds weird, think of
it as the <code class="language-plaintext highlighter-rouge">__init__</code> function in a Python class. If this also sounds weird,
just think of it as a simple function where we implement the model.</p>
</blockquote>

<h5 id="the-n_p-planets">The $N_p$ planets</h5>

<p><strong>kima</strong> can model Keplerian functions, the RV signals induced by planets. But
the distinguishing feature is that the code can actually model a number <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">N_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> of
Keplerians, and <em>this number does not need to be fixed a priori</em>. In other
words, <strong>kima</strong> estimates the joint posterior distribution for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">N_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> and the
orbital parameters of the planets <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>, given some data <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">D</mi></mrow><annotation encoding="application/x-tex">\mathcal{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span></span></span></span>:</p>

<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>N</mi><mi>p</mi></msub><mo separator="true">,</mo><mi>θ</mi><mi mathvariant="normal">∣</mi><mi mathvariant="script">D</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> p(N_p, \theta | \mathcal{D} ) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span><span class="mclose">)</span></span></span></span></span></p>

<p>So <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">N_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> is actually a free parameter in the model (if we want). It is somewhat
of a special parameter, in that it only takes discrete values, but it’s
otherwise similar to other parameters in the model. In particular, it needs a
prior distribution as well.</p>

<p>This part of the model in <strong>kima</strong> can be set with a special pair of parameters
for the model constructor</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">RVmodel</span><span class="o">::</span><span class="n">RVmodel</span><span class="p">()</span> <span class="o">:</span> <span class="n">fix</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span> <span class="n">npmax</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>which define whether of not <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">N_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> is fixed and its value or prior distribution</p>

<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>p</mi></msub><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mtext mathvariant="monospace">npmax</mtext><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><mtext mathvariant="monospace">fix</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>∼</mo><mi mathvariant="script">U</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mtext mathvariant="monospace">npmax</mtext><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
    N_p 
    \begin{cases}
        = \texttt{npmax},                       &amp; \text{if \texttt{fix}}\\
        \sim \mathcal{U}(0, \texttt{npmax}),    &amp; \text{otherwise}
    \end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord text"><span class="mord texttt">npmax</span></span><span class="mpunct">,</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord texttt">npmax</span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if </span><span class="mord text"><span class="mord texttt">fix</span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">otherwise</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>

<p>Each of the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">N_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> planets has 5 orbital parameters</p>

<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mrow><mi>P</mi><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>e</mi><mo separator="true">,</mo><msub><mi>M</mi><mn>0</mn></msub><mo separator="true">,</mo><mi>ω</mi></mrow></mrow><annotation encoding="application/x-tex">
\theta = { P, K, e, M_0, \omega }
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span></span></span></span></span></span></p>

<p>corresponding to the orbital period, semi-amplitude, eccentricity, mean anomaly
at the epoch, and argument of periastron.</p>

<blockquote>
  <p><strong>units</strong><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> is in [days], <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span> is in [m/s], <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> is unitless,
and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">M_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">ω</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span></span></span></span> are in radians.</p>
</blockquote>

<p>By default, the epoch is set to the first observed time, but it can be changed
inside the constructor by setting the variable <code class="language-plaintext highlighter-rouge">M0_epoch</code>.</p>

<h5 id="the-background-model">The “background” model</h5>

<p>Besides the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">N_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> planets, <strong>kima</strong> models the RV observations as follows</p>

<ul>
  <li>by default</li>
</ul>

<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>∼</mo><mi mathvariant="script">N</mi><mrow><mo fence="true">(</mo><msub><mi>v</mi><mrow><mi>s</mi><mi>y</mi><mi>s</mi></mrow></msub><mtext> </mtext><mo separator="true">,</mo><mtext> </mtext><msup><mi>j</mi><mn>2</mn></msup><mo>+</mo><msubsup><mi>σ</mi><mi>i</mi><mn>2</mn></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
v_i \sim \mathcal{N} \left( v_{sys} \,,\: j^2+\sigma_i^2 \right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2141179999999998em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span></p>

<ul>
  <li>if using a Student-t likelihood</li>
</ul>

<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>∼</mo><mi mathvariant="script">T</mi><mrow><mo fence="true">(</mo><msub><mi>v</mi><mrow><mi>s</mi><mi>y</mi><mi>s</mi></mrow></msub><mtext> </mtext><mo separator="true">,</mo><mtext> </mtext><msup><mi>j</mi><mn>2</mn></msup><mo>+</mo><msubsup><mi>σ</mi><mi>i</mi><mn>2</mn></msubsup><mo separator="true">,</mo><mi>ν</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
v_i \sim \mathcal{T} \left( v_{sys} \,,\: j^2+\sigma_i^2, \nu \right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2141179999999998em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.06366em;">ν</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span></p>

<ul>
  <li>if using a Gaussian process</li>
</ul>

<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>∼</mo><mrow><mi mathvariant="script">G</mi><mi mathvariant="script">P</mi></mrow><mrow><mo fence="true">(</mo><mi mathvariant="bold-italic">μ</mi><mo>=</mo><msub><mi>v</mi><mrow><mi>s</mi><mi>y</mi><mi>s</mi></mrow></msub><mtext> </mtext><mo separator="true">,</mo><mtext> </mtext><mi mathvariant="bold-italic">Σ</mi><mo>=</mo><mi mathvariant="bold">K</mi><mo>+</mo><mo stretchy="false">(</mo><msup><mi>j</mi><mn>2</mn></msup><mo>+</mo><msubsup><mi>σ</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo><mtext> </mtext><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mtext> </mtext><mi mathvariant="bold">I</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
v \sim \mathcal{GP} \left( \boldsymbol{\mu} = v_{sys} \,,\: \boldsymbol{\Sigma} = {\bf K} + (j^2+\sigma_i^2)\,\delta_{ij}\,{\bf I} \right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2141179999999998em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.0593em;">G</span><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord"><span class="mord boldsymbol">μ</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.05451em;">Σ</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">I</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span></p>

<p>where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span> is a <em>jitter</em> parameter that represents additional white noise
variations not accounted for by the individual uncertainties.</p>

<p>When considering a long-term trend (by setting <code class="language-plaintext highlighter-rouge">trend=true</code>), instead of a
constant systemic velocity, we have</p>

<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>v</mi><mrow><mi>s</mi><mi>y</mi><mi>s</mi></mrow></msub><mo>→</mo><msub><mi>v</mi><mrow><mi>s</mi><mi>y</mi><mi>s</mi></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>+</mo><mi>s</mi><mi>l</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>×</mo><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><msub><mi>t</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mspace width="2em"></mspace><mrow><mtext>if </mtext><mtext mathvariant="monospace">degree</mtext></mrow><mo>≥</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>+</mo><mi>q</mi><mi>u</mi><mi>a</mi><mi>d</mi><mi>r</mi><mo>×</mo><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><msub><mi>t</mi><mi>m</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mspace width="1em"></mspace><mtext> </mtext><mrow><mtext>if </mtext><mtext mathvariant="monospace">degree</mtext></mrow><mo>≥</mo><mn>2</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>+</mo><mi>c</mi><mi>u</mi><mi>b</mi><mi>i</mi><mi>c</mi><mo>×</mo><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><msub><mi>t</mi><mi>m</mi></msub><msup><mo stretchy="false">)</mo><mn>3</mn></msup><mspace width="1em"></mspace><mtext> </mtext><mtext> </mtext><mrow><mtext>if </mtext><mtext mathvariant="monospace">degree</mtext></mrow><mo>=</mo><mn>3</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
v_{sys} \rightarrow v_{sys} 
  &amp; + slope \times (t-t_m) \qquad      \text{if \texttt{degree}} \ge 1\\
  &amp; + quadr \times (t-t_m)^2 \quad\,   \text{if \texttt{degree}} \ge 2\\
  &amp; + cubic \times (t-t_m)^3 \quad\:\: \text{if \texttt{degree}} = 3
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.548216em;vertical-align:-2.024108em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.524108em;"><span style="top:-4.684108em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.6358920000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.024108em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.524108em;"><span style="top:-4.684108em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">p</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:2em;"></span><span class="mord text"><span class="mord">if </span><span class="mord text"><span class="mord texttt">degree</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mord mathdefault">u</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">if </span><span class="mord text"><span class="mord texttt">degree</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span></span></span><span style="top:-1.6358920000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">u</span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord text"><span class="mord">if </span><span class="mord text"><span class="mord texttt">degree</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.024108em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>

<p>where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">t_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the mean of the times.</p>

<h5 id="the-known-objects">The known object(s)</h5>

<p>In known object (KO!) mode, <strong>kima</strong> considers some Keplerians as part of the
“background” model. These are not included in the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">N_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> other planets and so
their number is fixed.</p>

<p>For example, if we know of a transiting planet orbiting a given star, we can set</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">const</span> <span class="kt">bool</span> <span class="n">known_object</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">n_known_object</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>

<p>and use information derived from the transit in the priors (see below).</p>

<p>Let’s imagine we now set</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">RVmodel</span><span class="o">::</span><span class="n">RVmodel</span><span class="p">()</span> <span class="o">:</span> <span class="n">fix</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span> <span class="n">npmax</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<p>This would mean that our model asserts the presence of one Keplerian signal and
we are trying to test up to three additional Keplerians. In other words, our
inference on the posterior for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">N_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> is <em>conditioned</em> on the existence of the
known object.</p>

<h5 id="setting-the-priors">Setting the priors</h5>

<p>As in any Bayesian analysis, <strong>kima</strong> needs a set of priors for the model
parameters. If we don’t explicitly set the priors in the <code class="language-plaintext highlighter-rouge">kima_setup.cpp</code> file,
a default prior will be used and the model will run. But sometimes (most times?)
we will want to set custom priors for some parameters.</p>

<p>To change specific priors, we just need to re-define some variables inside the
<code class="language-plaintext highlighter-rouge">RVmodel</code> constructor. <strong>The most important</strong> thing is that the priors for the
planet orbital parameters require the <code class="language-plaintext highlighter-rouge">conditional</code> object, while the priors for
the other parameters don’t.</p>

<p>For example, we can define two new priors</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">RVmodel</span><span class="o">::</span><span class="n">RVmodel</span><span class="p">()</span> <span class="o">:</span> <span class="n">fix</span><span class="p">(</span><span class="nb">true</span><span class="p">),</span> <span class="n">npmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// define new prior for the extra white noise parameter, j</span>
    <span class="n">Jprior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">Uniform</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">);</span> <span class="c1">// in m/s</span>

    <span class="c1">// get the conditional prior object</span>
    <span class="k">auto</span> <span class="n">conditional</span> <span class="o">=</span> <span class="n">planets</span><span class="p">.</span><span class="n">get_conditional_prior</span><span class="p">();</span>

    <span class="c1">// define new prior for the orbital period(s)</span>
    <span class="n">conditional</span><span class="o">-&gt;</span><span class="n">Pprior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">Gaussian</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">15.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">);</span> <span class="c1">// in days</span>
<span class="p">}</span>
</code></pre></div></div>

<blockquote>
  <p>note the small difference in syntax when defining the two priors.</p>
</blockquote>

<p>While it might seem counter-intuitive at first, in <strong>kima</strong> the priors for the
orbital parameters are <em>the same</em> for all <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">N_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> planets. This is intentional!<br>
If this is <em>not</em> what you want, consider using the known object feature.</p>

<p>In the example above, the argument between <code class="language-plaintext highlighter-rouge">&lt; &gt;</code> in the calls to the
<code class="language-plaintext highlighter-rouge">make_prior</code> function (called <em>template</em> arguments) specify the prior
distribution and the arguments inside parentheses set the parameters of each
distribution.</p>

<p><strong>kima</strong> (and DNest4) currently implement the following distributions:</p>

<table>
  <thead>
    <tr>
      <th>distribution</th>
      <th>arguments</th>
      <th>link</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Uniform</code></td>
      <td>lower, upper</td>
      <td>
<a href="https://en.wikipedia.org/wiki/Continuous_uniform_distribution">wiki</a>, <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.uniform.html">scipy</a><sup>!</sup>
</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">LogUniform</code></td>
      <td>lower, upper</td>
      <td><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.loguniform.html">scipy</a></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ModifiedLogUniform</code></td>
      <td>knee, upper</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Rayleigh</code></td>
      <td>scale</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Triangular</code></td>
      <td>lower, center, upper</td>
      <td>
<a href="https://en.wikipedia.org/wiki/Triangular_distribution">wiki</a>, <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.triang.html">scipy</a>
</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Laplace</code></td>
      <td>center, width</td>
      <td><a href="https://en.wikipedia.org/wiki/Laplace_distribution">wiki</a></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Kumaraswamy</code></td>
      <td>alpha, beta</td>
      <td><a href="https://en.wikipedia.org/wiki/Kumaraswamy_distribution">wiki</a></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Gaussian</code></td>
      <td>mean, stdev</td>
      <td>
<a href="https://en.wikipedia.org/wiki/Normal_distribution">wiki</a>, <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html">scipy</a>
</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Exponential</code></td>
      <td>mean</td>
      <td><a href="https://en.wikipedia.org/wiki/Exponential_distribution">wiki</a></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Cauchy</code></td>
      <td>location, scale</td>
      <td>
<a href="https://en.wikipedia.org/wiki/Cauchy_distribution">wiki</a>, <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.cauchy.html">scipy</a>
</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Fixed</code></td>
      <td>value</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">TruncatedGaussian</code></td>
      <td>mean, stdev, lower, upper</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">TruncatedCauchy</code></td>
      <td>location, scale, lower, upper</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>If you need a distribution that is not yet implemented, consider opening an
<a href="https://github.com/j-faria/kima/issues" target="_blank">issue</a>.</p>

<h6 id="checking-if-the-priors-are-correct">Checking if the priors are correct</h6>

<p>For any <strong>kima</strong> model, it’s very easy to check if the priors are set up
correctly. In the <code class="language-plaintext highlighter-rouge">OPTIONS</code> file, set the maximum number of levels to 1, and run
the model as usual. With this setting, DNest4 will sample directly from the
priors and ignore the likelihood.</p>

<p>The <code class="language-plaintext highlighter-rouge">kima-checkpriors</code> script is provided with the <code class="language-plaintext highlighter-rouge">pykima</code> package to make
histograms of the samples of each parameter. Simply call it with the column or
the name of the parameter you want to check (look inside <code class="language-plaintext highlighter-rouge">sample.txt</code> to see
which one is which)</p>

<p>For example</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kima-checkpriors 1
</code></pre></div></div>

<p>might print</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Histogram of column 1: jitter
number of samples: 10000
max value: 1999.744937
min value: 0.000128
</code></pre></div></div>

<p>and display the histogram of the prior samples:</p>

<p><img src="https://image.ibb.co/bKtfEd/priorJ.png" alt=""></p>

<h6 id="default-priors">Default priors</h6>

<p>Below is the list of default priors which are used if not explicitly re-defined
in the model constructor.</p>

<details>
  <summary>expand</summary>

  <ul>
    <li>
      <p>orbital periods and semi-amplitudes<br>
units: days and m/s, respectively</p>

      <div class="language-c++ highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1">// if hyperpriors = false (default)</span>
<span class="n">Pprior</span> <span class="o">=</span> <span class="n">make_shared</span><span class="o">&lt;</span><span class="n">LogUniform</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">);</span>
<span class="n">Kprior</span> <span class="o">=</span> <span class="n">make_shared</span><span class="o">&lt;</span><span class="n">ModifiedLogUniform</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">);</span>

<span class="c1">// if hyperpriors = true</span>
<span class="n">Pprior</span> <span class="o">=</span> <span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Laplace</span><span class="o">&gt;</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">log_muP</span><span class="p">),</span> <span class="n">wP</span><span class="p">);</span>
<span class="n">Kprior</span> <span class="o">=</span> <span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Exponential</span><span class="o">&gt;</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">log_muK</span><span class="p">));</span>
</code></pre></div>      </div>
    </li>
    <li>orbital eccentricities
      <div class="language-c++ highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="n">eprior</span> <span class="o">=</span> <span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Uniform</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</code></pre></div>      </div>

      <p>another good option could be</p>
      <div class="language-c++ highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="n">eprior</span> <span class="o">=</span> <span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Kumaraswamy</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">0.867</span><span class="p">,</span> <span class="mf">3.03</span><span class="p">);</span>
</code></pre></div>      </div>
      <p>which approximates the Beta distribution proposed by Kipping (2013).</p>
    </li>
    <li>
      <p>orbital phase and argument of periastron<br>
units: radians</p>

      <div class="language-c++ highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="n">phiprior</span> <span class="o">=</span> <span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Uniform</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="p">);</span>
    
<span class="n">wprior</span> <span class="o">=</span> <span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Uniform</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="p">);</span>
</code></pre></div>      </div>
    </li>
    <li>
      <p>systemic velocity<br>
units: m/s</p>

      <div class="language-cpp highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="n">Cprior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">Uniform</span><span class="o">&gt;</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">get_RV_min</span><span class="p">(),</span> <span class="n">data</span><span class="p">.</span><span class="n">get_RV_max</span><span class="p">());</span>
</code></pre></div>      </div>
    </li>
    <li>
      <p>additional white noise, or <em>jitter</em><br>
units: m/s</p>

      <div class="language-c++ highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="n">knee</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">data</span><span class="p">.</span><span class="n">get_max_RV_span</span><span class="p">())</span> 
<span class="n">upper</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">get_max_RV_span</span><span class="p">()</span>

<span class="n">Jprior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">ModifiedLogUniform</span><span class="o">&gt;</span><span class="p">(</span><span class="n">knee</span><span class="p">,</span> <span class="n">upper</span><span class="p">);</span>
</code></pre></div>      </div>
    </li>
    <li>ccoefficients of the trend (if trend=true)<br>
units: m/s/day, m/s/day², m/s/day³
      <div class="language-c++ highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="n">slope_prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">Gaussian</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">data</span><span class="p">.</span><span class="n">get_trend_magnitude</span><span class="p">(</span><span class="mi">1</span><span class="p">)));</span>
  <span class="n">quadr_prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">Gaussian</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">data</span><span class="p">.</span><span class="n">get_trend_magnitude</span><span class="p">(</span><span class="mi">2</span><span class="p">)));</span>
  <span class="n">cubic_prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">Gaussian</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">data</span><span class="p">.</span><span class="n">get_trend_magnitude</span><span class="p">(</span><span class="mi">3</span><span class="p">)));</span>
</code></pre></div>      </div>
    </li>
    <li>
      <p>between-instrument offsets
units: m/s</p>

      <div class="language-c++ highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="n">lower</span> <span class="o">=</span> <span class="o">-</span><span class="n">data</span><span class="p">.</span><span class="n">get_RV_span</span><span class="p">();</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">get_RV_span</span><span class="p">();</span>
<span class="n">offsets_prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">Uniform</span><span class="o">&gt;</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">);</span>
</code></pre></div>      </div>
    </li>
    <li>
      <p>GP hyperparameters<br>
units: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\eta_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> in m/s, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\eta_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">\eta_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> in days</p>

      <div class="language-c++ highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="n">log_eta1_prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">Uniform</span><span class="o">&gt;</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>

<span class="n">eta2_prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">LogUniform</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>

<span class="n">eta3_prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">Uniform</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">);</span>

<span class="n">log_eta4_prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">Uniform</span><span class="o">&gt;</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</code></pre></div>      </div>
    </li>
    <li>
      <p>degrees of freedom for Student-t likelihood</p>

      <div class="language-c++ highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="n">nu_prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">LogUniform</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
</code></pre></div>      </div>
    </li>
    <li>
      <p>moving average parameters</p>

      <div class="language-c++ highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="n">sigmaMA_prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">Uniform</span><span class="o">&gt;</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">tauMA_prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">LogUniform</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
</code></pre></div>      </div>
    </li>
    <li>
      <p>hyperparameters for orbital period and semi-amplitude hierachical priors<br>
only if <code class="language-plaintext highlighter-rouge">hyperpriors=true</code></p>

      <div class="language-c++ highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="n">log_muP_prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">TruncatedCauchy</span><span class="o">&gt;</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">365</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">log</span><span class="p">(</span><span class="mi">365</span><span class="p">)</span><span class="o">-</span><span class="mi">21</span><span class="p">,</span> <span class="n">log</span><span class="p">(</span><span class="mi">365</span><span class="p">)</span><span class="o">+</span><span class="mi">21</span><span class="p">);</span>
    
<span class="n">wP_prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">Uniform</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">);</span>
    
<span class="n">log_muK_prior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">TruncatedCauchy</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.0</span><span class="p">,</span> <span class="mf">21.0</span><span class="p">);</span>
</code></pre></div>      </div>
    </li>
    <li>
      <p>correlation coefficients with activity indicators</p>

      <div class="language-c++ highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="n">betaprior</span> <span class="o">=</span> <span class="n">make_prior</span><span class="o">&lt;</span><span class="n">Gaussian</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</code></pre></div>      </div>
    </li>
  </ul>

</details>

<!-- 
#### Loading data

Here is how to provide **kima** with input data.  
By default, the inputs are timeseries of RV measurements. A typical RV data file
will have three columns

    time   RV   RVerror
    ...    ...  ...


These columns can be space (`␣`), TAB (`⇥`), or comma (`,`) separated.

> you can even mix separators in the same file! but why would you?

The file can actually have more columns; **kima** will only read the first 3.

Regarding units, the times are assumed to be in days. The RVs and RV errors can
either be given in m/s or in km/s, but both should be in the same units. In the
`kima_setup.cpp` file, you'll need to set the units as an option to the `load`
function:

```c++
// either
load(datafile, "ms", 0);
// or
load(datafile, "kms", 0);
```


The third (optional) argument to the `load` function tell **kima** how many
lines to skip in the header of the file. The default is 2.


In multi instrument mode (when `multi_instrument = true`), **kima** can load RV
data from more than one instrument. There are two options here:

- one single file with a fourth column indicating the instrument
- multiple files, one for each instrument

With the first option, **kima** expects a file like this

    time   RV   RVerror inst
    ...    ...  ...     ...

where the fourth column should have integer numbers identifying the instruments.
If using multiple files, all of them should have the same 3-column structure as
above.

To load the data in multi instrument mode, use the `load_multi` function

```c++
datafiles = {"file1", "file2"};
load_multi(datafiles, "ms", 2);

// OR (don't do both!)

datafile = "file3_4columns.txt";
load_multi(datafile, "ms", 1);
```

For more details, check out the example
[here](/blog/multi-instrument).

> make sure that `multi_instrument = true` when using the `load_multi` function,
> or that `multi_instrument = false` when using the `load` function.
###### Activity correlations

A brand-new feature is the ability to consider linear correlations with activity
indicators, such as CCF indicators or spectral indices. 

> this is experimental and usually *not a very good idea* ™

To do this, **kima** needs to read an extra timeseries (or multiple timeseries)
of the same size as the RV data. 

Imagine a data file structured like this

    time   RV   RVerror bis  a   b   fwhm
    ...    ...  ...     ...  ... ... ...

where the columns `bis` and `fwhm` represent the activity indicators we are
interested in including in the model. The `a` and `b` columns are to be ignored.
Using the `load` function, we can write


```c++
datafile = "file.txt";

indicators = {"BISECTOR", "", "", "fwhm"};

load(datafile, "ms", 1, indicators);
```

The `indicators` vector contains the names of the activity indicators we want to
use. As you can see, these *don't* necessarily need to match the column names!
When you need to skip a column in the file, just add a `""` to the vector.

Note that setting the vector like this

```c+++
indicators = {"BISECTOR", "", ""};
indicators = {"BISECTOR"};
indicators = {"bis"};
```

would ignore the `fwhm` column.


In the future, **kima** might be able to use other kinds of data, but for now
these are the options. Feel free to
[contribute](https://github.com/j-faria/kima/wiki/Contribute) to help us with
the development. Any help is greatly appreciated.


##### Analysis of results


###### Quick plots



After (and also during) a run, we can analyse the results produced by the
sampler using the `kima-showresults` script, available from `pykima`.

```bash
kima-showresults
```

Without arguments, the script will read the three files generated by DNest4
(`sample.txt`, `sample_info.txt` and `levels.txt`), print some information to
the terminal and create actual posterior samples (which are saved in the
`posterior_sample.txt` and `posterior_sample_info.txt` files).

In the terminal you will see the log-evidence of the current model, the
information, which gives an idea of the number of times the prior distribution
was compressed by a factor of e to obtain the posterior distribution, and the
effective sample size (ESS), which corresponds to the number of saved samples
which have a significant posterior weight. 

> The `posterior_sample.txt` file will contain a number of posterior samples
> equal to the ESS.

The script can also generate some plots

```
kima-showresults rv phase planets orbital gp extra
```

- `rv` will plot posterior realizations of the model over the RV measurements
- `phase` will also plot phase curves, assuming the maximum likelihood solution
- `planets` will plot the posterior distribution for the number of planets
- `orbital` will plot posteriors for some of the orbital parameters: the
  semi-amplitude, eccentricity, and orbital period)
- `gp` will plot the posteriors for the GP hyperparameters, if the model has a
  GP component
- `extra` will plot the posteriors for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mrow><mi>s</mi><mi>y</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">v_{sys}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>, the jitter <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span>, and any
  instrument offset.

> you can get more granularity or show just one specific plot by providing
> numbered arguments like this: `kima-showresults 1 6`.




 -->

</div>
  </main>

  <footer class="mt-auto py-3 text-center">

  <small class="text-muted mb-2">
    <!-- <i class="fas fa-code"></i> with <i class="fas fa-heart"></i> -->
    by <strong>João Faria</strong>
  </small>

  <div class="container-fluid justify-content-center">
<a class="social mx-1" href="mailto:joao.faria@astro.up.pt" style="color: #6c757d" onmouseover="this.style.color='#db4437'" onmouseout="this.style.color='#6c757d'">
      <i class="fas fa-envelope fa-1x"></i>
    </a>

</div>
<small id="attribution">
    theme: <a href="https://github.com/YoussefRaafatNasry/portfolYOU">portfolYOU</a>
  </small>
  
</footer>
  
  <!-- GitHub Buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

<!-- Bootstrap JS CDN -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- wow.js CDN & Activation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.js"></script>
<script> new WOW().init(); </script>

<!-- Initialize all tooltips -->
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>

</body>

</html>